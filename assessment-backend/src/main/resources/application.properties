spring.application.name=assessment-backend
env.server.host = "${SERVER_HOST:localhost}"
# server.address = "${SERVER_HOST:::}"
# Actuator configuration for health checks
management.endpoints.web.exposure.include=health
management.endpoint.health.show-details=always

# Database configuration
# Railway provides DATABASE_URL, or use individual PGHOST/PGPORT/etc variables
# Default port changed to 5432 (standard PostgreSQL port used by Railway)
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://${PGHOST:localhost}:${PGPORT:5432}/${PGDATABASE:skillsoft_assessment_dev}}
spring.datasource.username=${PGUSER:postgres}
spring.datasource.password=${PGPASSWORD:password}

# JPA/Hibernate configuration
spring.jpa.hibernate.ddl-auto=update
# Enable SQL logging for debugging JSONB updates (set to false in production)
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.physical_naming_strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
spring.jpa.properties.hibernate.globally_quoted_identifiers=false

# Enable Hibernate DEBUG logging for SQL parameters
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.orm.jdbc.bind=TRACE

# Jackson JSON configuration
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.deserialization.fail-on-unknown-properties=false
spring.jackson.default-property-inclusion=non_null

# Data initialization configuration
spring.sql.init.mode=always
spring.sql.init.platform=postgresql
spring.sql.init.continue-on-error=false
spring.jpa.defer-datasource-initialization=true

# Server configuration
server.port=${SERVER_PORT:8080}
server.servlet.context-path=/
spring.mvc.pathmatch.matching-strategy=ant-path-matcher

# Clerk Webhook Configuration
clerk.webhook.secret=${CLERK_WEBHOOK_SECRET:}

# Enhanced Exception Handler Configuration
app.exception-handler.include-stack-trace=false
app.exception-handler.include-binding-errors=true
app.exception-handler.include-exception-name=false

# Spring Boot Error Configuration
server.error.include-stacktrace=never
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-exception=false
server.error.whitelabel.enabled=false

# HikariCP connection pool settings for Railway cold starts
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.initialization-fail-timeout=60000

# Application logging (enable DEBUG for service layer)
logging.level.app.skillsoft.assessmentbackend.services=DEBUG
logging.level.app.skillsoft.assessmentbackend.controller=DEBUG

# 404 Error Handling Configuration
spring.mvc.throw-exception-if-no-handler-found=true
spring.web.resources.add-mappings=false
