spring.application.name=assessment-backend
env.server.host = "${SERVER_HOST:localhost}"
# server.address = "${SERVER_HOST:::}"
# Actuator configuration for health checks
management.endpoints.web.exposure.include=health
management.endpoint.health.show-details=always

# Database configuration
# Railway provides DATABASE_URL, or use individual PGHOST/PGPORT/etc variables
# Default port changed to 5432 (standard PostgreSQL port used by Railway)
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://${PGHOST:localhost}:${PGPORT:5432}/${PGDATABASE:skillsoft_assessment_dev}}
spring.datasource.username=${PGUSER:postgres}
spring.datasource.password=${PGPASSWORD:password}

# JPA/Hibernate configuration
spring.jpa.hibernate.ddl-auto=update
# Disable SQL logging in production (causes 500 logs/sec on Railway)
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.physical_naming_strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
spring.jpa.properties.hibernate.globally_quoted_identifiers=false

# ===== CRITICAL LOGGING CONFIGURATION FOR RAILWAY DEPLOYMENT =====
# Reduce Hibernate logging to WARN level (prevents 500 logs/sec)
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.orm.jdbc.bind=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN
logging.level.org.hibernate.type=WARN
logging.level.org.hibernate.engine.jdbc.spi.SqlExceptionHelper=ERROR
logging.level.org.springframework.jdbc=WARN
logging.level.org.springframework.jdbc.core=WARN

# Reduce framework logging to absolute minimum
logging.level.org.springframework=WARN
logging.level.org.springframework.web=WARN
logging.level.org.springframework.security=WARN
logging.level.com.zaxxer.hikari=ERROR
logging.level.com.fasterxml.jackson=ERROR
logging.level.org.apache.catalina=WARN
logging.level.org.apache.coyote=WARN
logging.level.org.apache.tomcat=WARN

# Application logging - WARN for controllers (reduce request logging spam)
# INFO only for critical services
logging.level.app.skillsoft.assessmentbackend=WARN
logging.level.app.skillsoft.assessmentbackend.services.impl.TestSessionServiceImpl=INFO
logging.level.app.skillsoft.assessmentbackend.controller=WARN
logging.level.root=WARN

# Jackson JSON configuration
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.deserialization.fail-on-unknown-properties=false
spring.jackson.default-property-inclusion=non_null

# Data initialization configuration
spring.sql.init.mode=always
spring.sql.init.platform=postgresql
spring.sql.init.continue-on-error=false
spring.jpa.defer-datasource-initialization=true

# Server configuration
server.port=${SERVER_PORT:8080}
server.servlet.context-path=/
spring.mvc.pathmatch.matching-strategy=ant-path-matcher

# Clerk Webhook Configuration
clerk.webhook.secret=${CLERK_WEBHOOK_SECRET:}

# Enhanced Exception Handler Configuration
app.exception-handler.include-stack-trace=false
app.exception-handler.include-binding-errors=true
app.exception-handler.include-exception-name=false

# Spring Boot Error Configuration
server.error.include-stacktrace=never
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-exception=false
server.error.whitelabel.enabled=false

# HikariCP connection pool settings for Railway cold starts
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.initialization-fail-timeout=60000

# 404 Error Handling Configuration
spring.mvc.throw-exception-if-no-handler-found=true
spring.web.resources.add-mappings=false
